{% extends 'seller_site/base.html' %}
{% load static %}
{% block content %}

<div class='container'>
<div class='text-center'><h1>{{title}}</h1></div>

  <br>
  <form action="" class="" method='get'>
    
  <select name='user_id' style="width: 20%;" class="form-select" aria-label="Default select example">
    <option selected>Продавцы</option>
    {% for u in users %}
    <option value="{{u.pk}}">{{u.first_name}} {{u.last_name}}</option>
    {% endfor %}
  </select>
  
  <br>
  <button name="seller_filter" type="submit">X</button>
</form>
  <br>

<div class="accordion" id="accordionExample">
    {% for qs in queryset %}
    <div class="accordion-item">
        <h2 class="accordion-header" id="headingOne">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{qs.pk}}"
                aria-expanded="true" aria-controls="collapse{{qs.pk}}">
                От {{qs.get_datetime}} на сумму {{ qs.price }} руб. (Продавец - {{qs.user.first_name}} {{qs.user.last_name}})
            </button>
        </h2>
        <div id="collapse{{qs.pk}}" class="accordion-collapse collapse " aria-labelledby="heading{{qs.pk}}"
            data-bs-parent="#accordionExample">
            <div class="accordion-body">
                <div class="text-center">
                <form action="" method='post'>
                    {% csrf_token %}
                <table class="table">
                    <thead>
                      <tr>
                        <th scope="col">#</th>
                        <th scope="col">Товар</th>
                        <th scope="col">Цена за 1 шт.</th>
                        <th scope="col">Кол-во</th>
                        <th scope="col">Общая сумма</th>
                      </tr>
                    </thead>
                    <tbody>
                        {% for product in qs.sold_product.all %}
                      <tr>
                        <th scope="row">{{forloop.counter}}</th>
                        <td>{{product.product.title}}</td>
                        <td>{{product.price}} руб.</td>
                        <td>
                            <input type="hidden" name="sold_id" value="{{product.pk}}">
                            <input style="width: 25%" type="number" id="user" name='sold_count' pattern="" value={{product.count}} required> шт.

                        </td>
                        <td>{% widthratio product.price 1 product.count %} руб.</td>
                      </tr>
                      {% endfor %}
                      <tr>
                        <th scope="row"></th>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td>Общая сумма - {{qs.price}} руб.</td>
                      </tr>
                    </tbody>
                  </table>
            </div>
                <br>
                <div class="text-end">
                <button type="submit" class="btn btn-success" name='change_order'>Изменить заказ</button>
            </div>
            </form>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

</div>

{% endblock %}


<!-- <label for="count" class="col-form-label" >{{item.product.title}} </label>
<style>
    #user {
     width: 50px; /* Ширина поля в пикселах */
    } 
   </style>
<input type="hidden" name="sold_id" value="{{item.pk}}">
<input type="number" id="user" name='sold_count' pattern="" value={{item.count}}> шт. - {% widthratio item.price 1 item.count %} руб.
<br> -->