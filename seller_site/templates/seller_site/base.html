<!doctype html>
<html lang="ru">

<head>
  <!-- Обязательные метатеги -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">


  <title>{{title}}</title>
</head>

<body>

  {% block header %}
  <header class="p-3 bg-dark text-white">
    <div class="container">
      <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">

        <a href="#"> 
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bullseye" viewBox="0 0 16 16">
              <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
              <path d="M8 13A5 5 0 1 1 8 3a5 5 0 0 1 0 10zm0 1A6 6 0 1 0 8 2a6 6 0 0 0 0 12z"/>
              <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8z"/>
              <path d="M9.5 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/>
            </svg>
         </a>

        <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
          {% url 'all_product_offline' as apo %}
          {% if request.path == apo %}
          <li><a href="{% url 'all_product_offline' %}" class="nav-link px-2 disabled">Все товары</a></li>
          {% else %}
          <li><a href="{% url 'all_product_offline' %}" class="nav-link px-2 text-white">Все товары</a></li>
          {% endif   %}
          {% url 'register' as r %}
          {% if request.path == r %}
          <li><a href="{% url 'register' %}" class="nav-link px-2 disabled">Регистрация продовца</a></li>
          {% else %}
          <li><a href="{% url 'register' %}" class="nav-link px-2 text-white">Регистрация продовца</a></li>
          {% endif %}
        </ul>

        <div class="text-end">
          <button type='button' class='btn btn-success' data-bs-toggle="modal" data-bs-target="#sellModal" >+ Продажа</button>

          <div class="btn-group">
            <div class="dropdown">
              <button class="btn btn-outline-light dropdown-toggle" type="button" id="dropdownMenuButton1"
                data-bs-toggle="dropdown" aria-expanded="false">
                + Категория
              </button>
              <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                {% url 'add_category' as ac %}
                {% if request.path == ac %}
                <li><a class="dropdown-item disabled" href="{% url 'add_category' %}">Онлайн магазин</a></li>
                {% else %}
                <li><a class="dropdown-item" href="{% url 'add_category' %}">Онлайн магазин</a></li>
                {% endif %}
                {% url 'category_offline' as co %}
                {% if request.path == co %}
                <li><a class="dropdown-item disabled" href="{% url 'category_offline' %}">Офлайн магазин</a></li>
                {% else %}
                <li><a class="dropdown-item" href="{% url 'category_offline' %}">Офлайн магазин</a></li>
                {% endif %}
              </ul>
            </div>
          </div><!-- /btn-group -->
          <div class="btn-group">
            <div class="dropdown">
              <button class="btn btn-warning me-3 dropdown-toggle" type="button" id="dropdownMenuButton1"
                data-bs-toggle="dropdown" aria-expanded="false">
                + Товар
              </button>
              <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                {% url 'add_product' as ap %}
                {% if request.path == ap %}
                <li><a class="dropdown-item disabled" href="#">Онлайн магазин</a></li>
                {% else %}
                <li><a class="dropdown-item" href="{% url 'add_product_offline' %}">Онлайн магазин</a></li>
                {% endif %}
                <li><a class="dropdown-item" href="{% url 'add_product_offline' %}">Оффлайн магазин</a></li>
              </ul>
            </div>
          </div><!-- /btn-group -->
          <a class="btn btn-danger " href="{% url 'logout' %}" role="button">Выход</a>
        </div>
      </div>
    </div>
  </header>
  {% endblock %}


  {% block message %}
  <div class='container'>
    {% if messages %}

    {% for message in messages %}
    <div class="alert alert-success" role="alert">{{ message }}</div>
    {% endfor %}

    {% endif %}
  </div>
  {% endblock %}




  <main class="flex-shrink-0">

    <br>
    {% block content %}
    <div class="container">

    </div>
    {% endblock %}

  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
    
    <script>
      var items=1;
      function AddItem() {
        div=document.getElementById("items");
        button=document.getElementById("add");
        items++;
        newitem='<div class="input-group mb-3"> <select class="form-select" name="product_id" id="product_id" required>';
        newitem+='{% for c in category %}';
        newitem+=' <optgroup style="color:blue" label="{{c}}">'
        newitem+='{% for sc in c.offlinesubcategory_set.all %}'
        newitem+='<optgroup style="color:red" label="&nbsp;&nbsp;&nbsp;&nbsp;{{sc}}">'
        newitem+='{% for p in sc.offlineproduct_set.all %}';
        newitem+='<option style="color:black" value="{{p.pk}}">&nbsp;&nbsp;&nbsp;&nbsp;{{p.title}}</option>'
        newitem+= '{% endfor %} {% endfor %}</optgroup>{% endfor %}</select>'
        newitem+= '<span class="input-group-text">@</span> <input type="number" name="product_count" class="form-control" placeholder="Кол-во" aria-label="count" required> </div>'
        newnode=document.createElement("span");
        newnode.innerHTML=newitem;
        div.insertBefore(newnode,button);
      }
      </script>

      

</body>

<!-- Модальное окно продажа начало -->
<div class="modal fade" id="sellModal" tabindex="-1" aria-labelledby="sellModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="sellModalLabel">Оформление заказа</h5>
      </div>
      <div class="modal-body">
        <form action="{% url 'teest' %}" name="form1" method='post'>
          {% csrf_token %}
        
          <div class="input-group mb-3">
            <select class="form-select" name="product_id" id='product_id' required>
              {% for c in category %}
              <optgroup style="color:blue" label="{{c}}">
                  {% for sc in c.offlinesubcategory_set.all %}
                  <optgroup style="color:red" label="&nbsp;&nbsp;&nbsp;&nbsp;{{sc}}">
                    {% for p in sc.offlineproduct_set.all %}
                    <option style="color:black" value="{{p.pk}}">&nbsp;&nbsp;&nbsp;&nbsp;{{p.title}}</option>
                  {% endfor %}
                  {% endfor %}
              </optgroup>
              {% endfor %}
            </select>
            <span class="input-group-text">@</span>
            <input type="number" name='product_count' class="form-control" placeholder="Кол-во" aria-label="count" required>
          </div>
        
          <div ID="items">
          <input type="button" value="Добавить поле" onClick="AddItem();" ID="add">
          </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
        <button type="submit" class="btn btn-success" name="sell">Оформить</button>
      </form>
      </div>
    </div>
  </div>
</div>
<!-- Модальное окно продажа конец  -->

</html>
